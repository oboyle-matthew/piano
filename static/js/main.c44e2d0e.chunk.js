(this.webpackJsonpbuilt_frontend=this.webpackJsonpbuilt_frontend||[]).push([[0],{111:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(4),o=n.n(i),l=(n(44),n(6)),s=n(7),c=n(10),u=n(8),h=n(17),d=n(9),f=(n(45),n(34)),p=n(23),m={C:0,D:2,E:4,F:5,G:7,A:9,B:11},g={0:"red",1:"black",2:"pink",3:"purple",4:"green",5:"cyan",6:"orange",7:"blue",8:"grey",9:"yellow",10:"navy",11:"brown"},v=function(e,t){return{width:0,height:0,backgroundColor:"transparent",borderStyle:"solid",borderLeftWidth:1*e,borderRightWidth:1*e,borderBottomWidth:2*e,borderLeftColor:"transparent",borderRightColor:"transparent",borderTopColor:"transparent",borderBottomColor:t}},b=function(e,t){return{width:2*e,height:2*e,borderRadius:2*e,backgroundColor:t}},y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={img:null},e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"sumUpTo",value:function(e,t){return e.filter((function(e,n){return n<t})).map((function(e){return parseInt(e[0].duration)})).reduce((function(e,t){return e+t}),0)}},{key:"getScore",value:function(e){var t=12*e.octave+m[e.note];return e.alter?t+parseInt(e.alter):t}},{key:"getMinScore",value:function(e){var t=this;return Math.min.apply(Math,Object(p.a)(e.map((function(e){return t.getScore(e[0])})).filter((function(e){return!Number.isNaN(e)}))))}},{key:"getMaxScore",value:function(e){var t=this;return Math.max.apply(Math,Object(p.a)(e.map((function(e){return t.getScore(e[0])})).filter((function(e){return!Number.isNaN(e)}))))}},{key:"convertToVisual",value:function(e,t,n,r,i){var o=g[this.getScore(e)%12];if("4"===e.octave)return a.a.createElement("div",{style:{position:"absolute",width:r,top:t,left:n}},a.a.createElement("div",{style:b(i,o)}));if("5"===e.octave)return a.a.createElement("div",{style:{position:"absolute",width:r,top:t,left:n}},a.a.createElement("div",{style:v(i,o)}));var l=e.note;return"1"===e.alter?l+="#":"-1"===e.alter&&(l+="b"),a.a.createElement("div",{style:{position:"absolute",width:r,height:2*i,top:t,left:n,fontSize:2*i}},l)}},{key:"render",value:function(){var e=this,t=this.props,n=t.beats,r=t.beatLength,i=t.multiplier,o=t.height,l=t.widthRatio,s=t.incrementMultiplier,c=t.leftNotes,u=t.rightNotes,h=t.radius,d=n*r*i,f=this.getMaxScore(u),p=this.getMinScore(u),m=this.getMaxScore(c),g=this.getMinScore(c);return a.a.createElement("div",{style:{width:d,overflowX:"none",marginTop:50}},a.a.createElement("div",{id:"capture"},a.a.createElement("div",{style:{position:"relative"}},u.map((function(t,n){var r=o*Math.floor(e.sumUpTo(u,n)/d);1===t.length&&(r+=(1-(e.getScore(t[0])-p)/(f-p))*s);var i=l*(e.sumUpTo(u,n)%d),c=t[0].duration*l;return a.a.createElement("div",null,t.map((function(n,a){var o=r+a/t.length*s;return e.convertToVisual(n,o,i,c,h/t.length)})))}))),a.a.createElement("div",{style:{position:"relative"}},c.map((function(t,n){var r=e.props.handDiff+o*Math.floor(e.sumUpTo(c,n)/d);1===t.length&&(r+=(1-(e.getScore(t[0])-g)/(m-g))*s);var i=l*(e.sumUpTo(c,n)%d),u=t.duration*l;return a.a.createElement("div",null,t.map((function(n,a){var o=r+a/t.length*s;return e.convertToVisual(n,o,i,u,h/t.length)})))}))),a.a.createElement("div",{style:{position:"relative"}},u.map((function(t,n){t=t[0];var r=o*Math.floor(e.sumUpTo(u,n)/d);return r-=e.props.radius,a.a.createElement("hr",{style:{position:"absolute",top:r,left:0,width:d*l}})})))),a.a.createElement("div",{id:"test"}," "))}}]),t}(r.Component),S=n(35),w=n.n(S),E=n(22),L=n(36),k=n.n(L),M=n(37),O=n.n(M);function j(e,t){return null===e.querySelector(t)?null:e.querySelector(t).innerHTML}function x(e){return null!==e.querySelector("chord")}function I(e){var t=e.querySelectorAll("note");e.querySelectorAll("score-part").length>2&&(t=e.querySelectorAll("part")[0].querySelectorAll("note"));var n=[],r=[],a=[],i=[];t.forEach((function(e){var t=function(e){return{note:j(e,"step"),octave:j(e,"octave"),alter:j(e,"alter"),duration:j(e,"duration"),type:j(e,"type")}}(e);"2"===j(e,"staff")?(!x(e)&&a.length>0&&(n.push(a.reverse()),a=[]),a.push(t)):(!x(e)&&i.length>0&&(r.push(i.reverse()),i=[]),i.push(t))}));var o=e.querySelector("beats").innerHTML,l=e.querySelector("measure"),s=0;l.querySelectorAll("note").forEach((function(e){e.querySelector("chord")||e.querySelector("staff")&&"1"!==e.querySelector("staff").innerHTML||(console.log(e.innerHTML),s+=parseInt(e.querySelector("duration").innerHTML))}));var c=e.querySelectorAll("measure")[e.querySelectorAll("measure").length>1?1:0],u=0;c.querySelectorAll("note").forEach((function(e){e.querySelector("chord")||e.querySelector("staff")&&"1"!==e.querySelector("staff").innerHTML||(console.log(e.innerHTML),u+=parseInt(e.querySelector("duration").innerHTML))}));var h=u-s;return h>0&&(n.unshift([{note:null,octave:null,alter:null,duration:h,type:null}]),r.unshift([{note:null,octave:null,alter:null,duration:h,type:null}])),{left:n,right:r,beats:o,beatLength:u/o}}var T=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={beats:4,beatLength:64,radius:20,height:320,widthRatio:2,barsPerLine:2,incrementMultiplier:100,handDiff:250,selectedFile:null,left:[],right:[],hidden:!0,file_name:"",linesInPdf:3},e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){e!==this.props&&this.resetScreen()}},{key:"resetScreen",value:function(){var e=this.props,t=e.beats,n=e.beatLength,r=window.innerWidth<800?1:2,a=window.innerWidth/(t*n*r),i=window.innerWidth/(t*r*8),o=window.innerHeight/2;this.setState({widthRatio:a,barsPerLine:r,radius:i,height:o,incrementMultiplier:100,handDiff:.35*o,linesInPdf:3,beatLength:n})}},{key:"createSlider",value:function(e,t,n,r,i){var o=this;return a.a.createElement(E.ListItem,null,a.a.createElement("label",null,e,a.a.createElement("input",{type:"range",min:n,max:r,step:i,value:this.state[t],onChange:function(e){return o.setState(Object(f.a)({},t,e.target.value))}})))}},{key:"takeScreenshot",value:function(){var e=document.getElementById("capture"),t=this;k.a.toPng(e).then((function(e){var n=new Image;n.src=e,n.onload=function(){for(var e=n.width,r=t.state.height*t.state.linesInPdf,a=new O.a("l","mm","a4"),i=0;i<n.height/r;i++){var o=document.createElement("canvas");o.width=e,o.height=r,o.getContext("2d").drawImage(n,0,r*i,e,r,0,0,e,r);var l=new Image;l.src=o.toDataURL(),a.addImage(l,"png",10,10,280,202),i+1<n.height/r&&a.addPage()}console.log(t.props.file_name),a.save(t.props.file_name+".pdf")}})).catch((function(e){console.error("oops, something went wrong!",e)}))}},{key:"render",value:function(){var e=this,t=w.a.slide,n=this.props,r=n.left,i=n.right,o=n.beats,l=this.state,s=l.radius,c=l.height,u=l.widthRatio,h=l.barsPerLine,d=l.incrementMultiplier,f=l.handDiff,p=l.file_name,m=l.beatLength;console.log(u);var g=a.a.createElement("div",null,a.a.createElement("h1",{style:{width:"150%",marginLeft:"-30%",textAlign:"center"}},"Customize notes:"),this.createSlider("Size of Notes","radius",5,50,1),this.createSlider("Gap between hands","handDiff",20,300,1),this.createSlider("Line Height","height",100,1e3,1),this.createSlider("Line Width","widthRatio",0,10,.1),this.createSlider("Bars per line","barsPerLine",1,5,1),this.createSlider("Pitch Difference","incrementMultiplier",0,300,1),a.a.createElement("button",{style:{marginLeft:"15%",marginTop:"10%",marginBottom:"25%"},onClick:function(){return e.resetScreen()}},"Reset sizes"),a.a.createElement("h1",{style:{width:"150%",marginLeft:"-30%",textAlign:"center"}},"Download:"),this.createSlider("Lines per page in pdf","linesInPdf",1,7,1),a.a.createElement("button",{style:{marginLeft:"12%",marginTop:"10%"},onClick:function(){return e.takeScreenshot()}},"Download music"));return a.a.createElement("div",{id:"outer-container",style:{height:"90%",position:"absolute",top:0,left:0,zIndex:-2}},a.a.createElement(t,{styles:{bmBurgerButton:{position:"absolute",width:"36px",height:"30px",left:"24px",top:"24px"},bmBurgerBars:{background:"#373a47"},bmCrossButton:{height:"24px",width:"24px"},bmCross:{background:"#bdc3c7"},bmMenu:{background:"#373a47",padding:"2.5em 1.5em 0",fontSize:"1.15em"},bmMorphShape:{fill:"#373a47"},bmItemList:{color:"#b8b7ad",padding:"0.8em"},bmOverlay:{background:"rgba(0, 0, 0, 0.3)"}},noOverlay:!0,id:"slide",pageWrapId:"page-wrap",outerContainerId:"outer-container"},a.a.createElement(E.List,null,g)),a.a.createElement("div",{id:"page-wrap"},a.a.createElement(y,{style:{zIndex:-1},beats:o,beatLength:m,multiplier:h,incrementMultiplier:d,handDiff:parseInt(f),radius:s,height:parseInt(c),widthRatio:u,rightNotes:i,leftNotes:r,file_name:p})))}}]),t}(r.Component),q=n(38),C=n.n(q),N=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).handleSelectedFile=function(t){e.setState({selectedFile:t.target.files[0]})},e.handleFileRead=function(t){var n=e.state.selectedFile,r=e.props.updateNotes,a=I((new DOMParser).parseFromString(t.target.result,"text/xml"));r&&r(a,n.name)},e.state={selectedFile:null},e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"handleUpload",value:function(){var e,t;return C.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:e=this.state.selectedFile,(t=new FileReader).onloadend=this.handleFileRead,t.readAsText(e);case 4:case"end":return n.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement("div",{style:{marginLeft:"20%",display:"flex",flexDirection:"row"}},a.a.createElement("input",{style:{width:"20%"},type:"file",name:"",id:"",onChange:this.handleSelectedFile}),a.a.createElement("div",{style:{width:"20%"}},a.a.createElement("button",{onClick:function(){return e.handleUpload()}},"Upload"))))}}]),t}(r.Component),D=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={left:[],right:[],beats:4,name:"",beatLength:64},e.setNotes=e.setNotes.bind(Object(h.a)(e)),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"normalizeNotes",value:function(e){}},{key:"setNotes",value:function(e,t){this.setState({left:e.left,right:e.right,beats:e.beats,name:t,beatLength:e.beatLength})}},{key:"render",value:function(){var e=this.state,t=e.left,n=e.right,r=e.beats,i=e.beatLength,o=e.name;return a.a.createElement("div",null,a.a.createElement(N,{updateNotes:this.setNotes}),a.a.createElement(T,{file_name:o,left:t,right:n,beats:r,beatLength:i}))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},39:function(e,t,n){e.exports=n(111)},44:function(e,t,n){},45:function(e,t,n){}},[[39,1,2]]]);
//# sourceMappingURL=main.c44e2d0e.chunk.js.map